---
typora-copy-images-to: PhotosInMd


---

# Chapter 1 概述

## 1.1 计算机网络在信息时代中的作用

+ 三大类网络
  + 电信网络
  + 有线电视网络
  + 计算机网络

## 1.2 互联网概述

### 1.2.1 网络的网络

+ 网络把许多计算机连接在一起，而互联网吧许多网络通过路由器连接在一起。与网络相连的常称为主机。
+ 简单的物理连接不是网络，配合与协议等才是完整的

### 1.2.2 互联网基础结构发展的三个阶段

1. 单个网络ARPANET向互连网发展的过程
2. 建成了三级结构的互连网（主干网、地区网、校园网）
3. 逐渐形成多层次[ISP](https://baike.baidu.com/item/%E4%BA%92%E8%81%94%E7%BD%91%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E5%95%86/12508386?fromtitle=ISP&fromid=10152)结构的互连

+ 根据提供服务的覆盖面积大小以及所拥有的IP地址数目不同，ISP分为不同层次：
  + 主干ISP
  + 地区ISP
  + 本地ISP
+ IXP(Internet eXchange Point)互连网交换点用于优化速度，高效利用网络资源，主要作用是允许两个网络直接相连并交换分组，不需要再通过第三个网络来转发分组

### 1.2.3 互联网的标准化工作

+ 标准制定的时机不宜过早过晚，过早技术未发展至成熟水平，旧技术限制新技术，过晚使技术发展无章可循产品相互不兼容。
+ ISOC(Internet Society) 互联网协会
  + IAB(Internet Architecture Board) 互联网体系结构委员会
    + 互联网工程部 IETF
    + 互联网研究部 IRTF
  + RFC(Request of Comments) 文档
+ 制定互联网的正式标准要经过以下三个阶段
  1. 互联网草案
  2. 建议标准（成为RFC文档）
  3. 互联网标准

## 1.3 互联网的组成

+ 互联网从工作方式上看分为两大块
  + 边缘部分：由所有连接在互联网上的主机组成。这部分由用户直接使用，用来进行通信和资源共享
  + 核心部分：由大量网络和连接这些网络的路由器组成。这部分使为边缘部分提供服务的。

### 1.3.1 互联网的边缘部分

+ **主机A的某个进程和主机B的另一个进程通信**

+ 边缘部分利用核心部分所提供的服务使众多的主机之间能够互相通信并交换或共享信息

+ 网络边缘的端系统之间的通信方式通常可划分为两大类：

  + **客户-服务器方式（C/S方式）**
    客户是服务请求方，服务器是服务提供方。
    **客户程序特点：**

    1. 被用户调用后运行，在通信时主动向远地服务器发起通信请求服务。
    2. 不需要特殊的硬件和很复杂的操作系统。

    **服务器程序特点：**

    1. 是一种专门用来提供某种服务的程序，可同时处理多个远地或本地客户的请求
    2. 系统启动后即调用并一直不断地运行着，被动地等待并接受来自各地的客户的通信请求。服务器程序不需要知道客户程序地址。
    3. 客户与服务器的通信关系建立后，通信可以是双向的，客户与服务器都可发送和接收数据。

  + **对等方式（P2P方式）**
    Peer-to-peer
    既是C又是S

### 1.3.2 互联网的核心部分

1. **电路交换主要特点**
   + 电话机数量大时电线**数量太大**
   + **步骤**：建立连接-通话（持续占用）-释放连接
   + 通话的全部时间内，通话的两个用户始终占用端到端的通信资源，资源利用率太低
2. **分组交换的主要特点**

   + 采用**存储转发技术**
   + 发送的整块数据称为一个**报文(message)**，添加**首部**之后可构成分组，又称**包**，首部可称**包头**
   + 《**主机**是为用户进行信息处理的，**路由器**是用来转发分组的，即进行分组交换

   + **路由器的短分组暂存在内存中而非磁盘中**以保证较高的交换速率
   + 路由器步骤：暂存-查表-发出
   + **分组交换优点**：*高效、灵活、迅速、可靠* 
3. **报文交换**是将整个报文以路由转发传送至目的地

## 1.4 计算机网络在我国的发展

## 1.5 计算机网络的定义

### 1.5.1 计算机网络的定义

1. 计算机网络所连接的硬件并不仅限于一般的计算机，还包括智能手机等。
2. 计算机网络并非专门用于传输数据，而能支持多种应用。

### 1.5.2 几种不同类别的计算机网络

1. 按照**网络作用范围**分类

   + **WAN** (Wide Area Network)  广域网：几十到几千公里

   + **MAN** (Metropolitan Area Network)  城域网：5~50公里

   + **LAN** (Local Area Network)  局域网：较小范围如1公里内

   + **PAN** (Private Area Network)  个人区域网：范围很小如10米

     <!-- 太近的中央处理机当作多处理机系统而非计算机网络 -->

2. 按照**网络的使用者**分类

   + **公用网** (Public Network)
   + **专用网** (Private Network)

3. 用来把用户接入到互联网的网络

   + **AN** (Access Network) **接入网**或称本地接入网或居民接入网

     **接入网本身不属于互联网的核心部分，也不属于边缘部分**

   + 从覆盖的范围看，很多接入网还是属于局域网

   + 作用上看，接入网只是起到让用户能够与互联网连接的“桥梁”作用

## 1.6 计算机网络的性能

### 1.6.1 计算机网络的性能指标

1. **速率**

   + **数据的传输速率**
   + **数据率**或**比特率**

   + 网络速率往往指的是 **额定速率** 或 **标称速率**

2. **带宽**

   1. **某个信号具有的频带宽度**
      + 某信道允许通过的信号频带范围就称为该信道的带宽
      + 单位：**赫兹**
   2. 网络中某**通道**传送数据的能力
      + 在单位时间内网络中的某信道所能通过的”最高数据率”
      + 单位：bit/s

3. **吞吐量**

   + 在单位时间内通过某个网络（或信道、接口）的实际的数据量
   + 多用于网络测量

4. **时延**

   + **发送时延**

     主机或路由器发送数据帧所需要的时间，即发送第一比特算起到发送完最后一个比特为止。

     ![image-20200208114640331](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208114640331.png)

   + **传播时延**

     电磁波在信道中传播一定距离需要花费的时间。

     ![image-20200208114911047](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208114911047.png)

   + 处理时延

     主机或路由器在收到分组时嗷花费一定的时间进行处理，例如分析分组的首部、从分组中提取数据部分、进行差错检验或查找适当的路由等，这就产生了处理时延。

   + 排队时延

     路由器转发过程中排队消耗的时间。

     ![image-20200208185700043](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208185700043.png)

![image-20200208185854770](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208185854770.png)

**对于高速网络链路，我们提高的仅仅是数据的发送速率而不是比特在链路上的传播速率。传播速率相对恒定，参考光速。**

5. **时延带宽积**

   ![image-20200208190609260](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208190609260.png)

   + 以比特为单位的链路长度

     ![image-20200208190931697](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208190931697.png)

6. **往返时间RTT**

   + 用于判定双方交互一次的时间。

   + 在互联网中，往返时间还包括各中间节点的处理时延、排队时延以及转发数据时的发送时延。卫星通信时RTT相对较长，是很重要的一个性能指标。

   + 

7. **利用率**

   + 信道利用率

     令D0 表示网络空闲时的时延，D表示网络当前的时延，则在适当的假定条件下，可以用下面的简单公式表示D和D0之间的关系：![image-20200208192021821](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208192021821.png)

   + 网络利用率

     + 当网络利用率达到容量的1/2时就要加倍。

     + 信道或网络的利用率过高会产生非常大的时延。

       <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208192212142.png" alt="image-20200208192212142" style="zoom:60%;" />

### 1.6.2 计算机网络的非功能特征

	1. 费用
	
	  	2. 质量
	          	3. 标准化
	         	4. 可靠性
	                  	5. 可扩展性和可升级性
	                 	6. 易于管理和维护

## 1.7 计算机网络体系结构

### 	1.7.1 计算机网络体系结构的形成

​		**开放系统互连基本参考模型OSI/RM ( Open System Interconnection Reference Model)**

​		但是OSI太晚进入市场，TCP/IP占有太多份额，因此TCP/IP占到先机

OSI缺点 

1. 缺乏经验，缺乏商业驱动力

2. 实现复杂，运行效率低
3. 指定周期太长，无法及时进入市场
4. 层次划分不合理，有些功能在多个层次中重复出现

### 	1.7.2 协议与层次划分

+ 规则明确规定了所交换数据的格式以及有关的同步问题
+ 分层的好处
  + 各层之间独立，层次间不需知道对方如何实现
  + 灵活性好
  + 结构上可分割开
  + 易于实现与维护
  + 能促进标准化工作
+ 各层所要完成的功能
  + 差错控制
  + 流量控制
  + 分段与重装
  + 复用和分用
  + 连接建立和释放
+ **计算机网络的各层及其协议的集合**就是网络的体系结构
+ 计算机网络的体系结构就是这个计算机网络及其构件所应完成的功能的精确定义
+ 体系结构是抽象的，而实现则是具体的，是真正在运行的计算机硬件和软件

### 1.7.3 具有五层协议的体系结构

1. **应用层（application layer）**
   + 通过应用进程间的交互来完成特定网络应用
   + 应用层协议定义的是应用进程间通信和交互的规则
   + 应用层交互的数据单元称为**报文**

2. **运输层（transport layer）**
   + 两台主机中进程间通信提供通用数据传输业务
     + TCP (Transmission Control Protocol) 传输控制协议
       + **面向连接**、**可靠**数据传输、传输单位 **报文段**
     + UDP(User Datagram Protocol) 用户数据报协议
       + **无连接**、尽最大努力（best-effort）、不保证可靠、传输单位 **用户数据报**
3. **网络层（network layer）**
   + 负责为分组交换网上的不同主机提供通信服务
   + 发送数据时，网络层把运输层产生的报文段或用户数据报封装成分组或包进行传送
   + 使用IP协议，分组也叫做IP数据报，或简称为数据报
   + 也称网际层，IP层

4. **数据链路层（data link layer）**
   + 简称链路层
   + 将网络层浇下来的IP数据报组装成帧，在相邻节点间的链路上传送帧
   + 每一帧包括数据和必要的控制信息
   + 帧有差错则**丢弃**该帧
5. **物理层（physical layer）**
   + 传输数据单位是比特
   + 有人将物理层下面的物理媒体当作第0层

+ **经常提到的TCP/IP协议并不一定单指具体的这两个协议，往往表示互联网所使用的整个TCP/IP协议族（protocol suite）**
+ **对等层**（peer layers）相同层次 相同协议
+ **协议栈**（protocol stack）类似栈的结构

### 1.7.4 实体、协议、服务和服务访问点

+ **实体（entity）**

  + 任何可发送或接收信息的硬件或软件进程

+ **协议（protocol)**

  + 控制两个对等实体进行通信的规则集合
  + 在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务，要实现本层协议，还需要使用下面一层所提供的服务
  + 协议是水平的

+ **服务访问点SAP（Service Access Point）**

  + 同一系统相邻两层的实体进行交互的地方。

+ **服务（service）**

  + 下层为上层提供服务

    ![image-20200208225705464](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208225705464.png)

### 1.7.5 TCP/IP 的体系结构

+ TCP/IP协议可为各式各样的应用提供服务（everything over IP）

+ 允许IP协议在各式各样的网络构成的互联网上运行

+ 沙漏计时器TCP/IP协议族

  <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200208230154611.png" alt="image-20200208230154611" style="zoom:60%;" />

# Chapter 2 物理层

## 2.1 物理层的基本概念

+ 物理层协议也称为物理层规程
+ 物理层的主要任务描述为确定与传输媒体的接口有关的一些特性：
  + 机械特性
  + 电气特性
  + 功能特性
  + 过程特性
+ 物理层还要完成计算机的**并行处理**与**串行传输**的转换

## 2.2 数据通信的基础知识

### 2.2.1 数据通信系统的模型

+ 一个数据通信系统可分为三大部分：
  + **源系统**（或发送端、发送方）
    + **源点（source）**：源点设备产生要传输的数据。
    + **发送器**：用于编码等的调制器
  + **传输系统**（或传输网络）
    + 
  + **目的系统**（或接收端、接收方）
    + **接收器**
    + **终点（destination）**
+ 常用术语
  + 通信的目的是传递 **消息**
  + **数据**是运送消息的实体
+ 信号分类
  + **模拟信号** 或 连续信号
  + **数字信号** 或 离散信号
+ 代表不同离散数值的基本波形就称为**码元**

### 2.2.2 有关信道的几个基本概念

+ **通信方式**

  + 单向通信（单工通信）
  + 双向交替通信（半双工通信）
  + 双向同时通信（全双工通信）
    + 全双工传输效率最高

+ **信号**

  + 来自信源的信号常称为 **基带信号（基本频带信号）**
  + 基带信号进行调制以优化传输质量
  + 波形变换——基带调制，编码
  + 载波调制得到带通信号——带通调制

+ **常用编码方式**

  ![image-20200209010243055](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209010243055.png)

  + **不归零制**：正电平代表1，负电平代表0。
  + **归零制**：正脉冲代表1，负脉冲代表0。
  + **曼彻斯特编码**：位周期中心的向上跳变代表0，为周期中心的向下跳变代表1。反过来定义也可。
  + **差分曼彻斯特编码**：在每一位的中心处始终都有跳变，位开始边界有跳变代表0，而位开始边界没有跳变代表1。

+ **基本的带通调制方法**

  ![image-20200209010812511](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209010812511.png)

### 2.2.3 信道的极限容量

+ 限制码元传输速率的因素有：

  + 信道能够通过的频率范围
  + 信噪比

+ **香农公式**

  + 信道的极限信息传输速率：

    <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209054026815.png" alt="image-20200209054026815" style="zoom:65%;" />

+ 让每个码元携带更多比特的信息量可提高信息的传输速率

## 2.3 物理层下面的传输媒体

![image-20200209054604114](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209054604114.png)

### 2.3.1 导引型传输媒体

+ **双绞线**

  + 也称双扭线
  + 外面加一层金属丝编织成的屏蔽层成为屏蔽双绞线STP

  ![image-20200209054631223](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209054631223.png)

![image-20200209054639693](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209054639693.png)![image-20200209054648438](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209054648438.png)

+ 同轴线缆

  ![image-20200209054942801](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209054942801.png)

+ 光缆

  <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209055000158.png" alt="image-20200209055000158" style="zoom:67%;" />

  + 多条不同角度入射的光线在一条光纤中传输称为多模光纤

### 2.3.2 非导引型传输媒体

+ 微波接力通信等

## 2.4 信道复用技术

### 2.4.1 频分复用、时分复用和统计时分复用

+ **复用**

  + 共享资源

    ![image-20200209140236119](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209140236119.png)

  ![image-20200209140421858](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209140421858.png)

  ![image-20200209140438723](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200209140438723.png)

  + 复用器与分用器成对使用可实现复用

### 2.4.2 波分复用

+ WDM ( Wavelength Division Multiplexing)
+ 光的频分复用

### 2.4.3 码分复用

+ CDM (Code Division Multiplexing)
+ CDMA (Code Division Multiplexing Access) 码分多址
+ 各用户使用经过特殊处理的码型，因此各用户之间不会造成干扰
+ 很强的抗干扰能力，频谱类似白噪声，不易被敌人发现
+ CDMA原理：
  + 利用各站点持有独有的码片序列，且不同站点间的码片序列相互正交的特点，过滤出需要接收的站点用到的码片序列，得到0 1 序列，实现复用。

## 2.5 数字传输系统

+ 早期数字传输系统存在许多缺点：
  + 速率标准不统一
  + 不是同步传输

## 2.6 宽带接入技术

### 2.6.1 ADSL技术——非对称数字用户线

+ (Asymmetric Digital Subscriber Line) 技术就是用数字技术对现有的模拟电话用户线进行改造，使它能够承载宽带业务。
+ 下行带宽远远大于上行带宽，即 **非对称**

### 2.6.2 光纤同轴混合网

+ (HFC网，Hybrid Fiber Coax)
+ 我国的HFC网段划分<img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200210190600838.png" alt="image-20200210190600838" style="zoom:55%;" />

### 2.6.3 FTTx技术

+ 光纤入户FTTH(Fiber To The Home)应当是最好的选择

+ 但价格稍贵，且不一定需要更高数据率

+ x代替H指光纤到达用户家附近即可

+ 无源光配网线的组成

  ![image-20200210191058833](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200210191058833.png)

+ 各种FTTx

  + 光纤到路边 FTTC curb

  + 光纤到小区 FTTZ zone
  + 光纤到大楼 FTTB building
  + 光纤到楼层 FTTF floor
  + 光纤到办公室 FTTO office
  + 光纤到桌面  FTTD desk

# Chapter 3 数据链路层

+ 数据链路层主要有以下两种类型

  + 点对点信道
  + 广播信道

+ 重要内容：

  + 数据链路层的点对点信道和广播信道的特点，以及两种信道所使用的协议（PPP协议以及CSMA/CS协议）的特点
  + 数据链路层的三个基本问题：
    + 封装成帧
    + 透明传输
    + 差错检测
  + 以太网MAC层的硬件地址
  + 适配器、转发器、集线器、网桥、以太网交换机的作用与使用场合。

+ 数据链路层地位

  ![image-20200211180726755](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200211180726755.png)

## 3.1 使用点对点信道的数据链路层

### 3.1.1 数据链路和帧

+ **链路**： 

  + 从一个节点到相邻节点的一段物理线路，中间没有任何其他的交换节点
  + 一条链路只是一条通路的一个组成部分

+ **数据链路**：

  + 除了物理线路外还需要各种协议来控制数据的传输。
  + 常用的如网络适配器
  + 也有人将数据链路分为**物理链路**与**逻辑链路**
  + 早期的数据通信协议叫做通信**规程**(procedure)

+ **帧**：

  + 点对点信道的数据链路层的协议数据单元
  + 数据链路层把网络层交下来的数据构成帧发送到链路上。
  + 点对点信道的数据链路层在进行通信时的主要步骤如下：
    1. 结点A的数据链路层把网络层交下来的IP数据报添加首部与尾部封装成帧
    2. 结点A把封装好的帧发送给结点B的数据链路层
    3. 若结点B的数据链路层收到的帧无差错，则从收到的帧中提取出IP数据报交给上面的网络层；否则丢弃这个帧

  <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200211182137497.png" alt="image-20200211182137497" style="zoom:50%;" />

### 3.1.2 三个基本问题

+ 数据链路层协议多种，三个基本问题相近：

  1. **封装成帧(framing)**

     + 添加首部与尾部

     + 首部尾部标识了一段一段比特流

     + 首部尾部一个重要的作用就是进行 **帧定界**（确定帧的界限）

     + 每一种链路层协议都规定了所能传送的帧的 **数据部分长度上限——最大传送单元MTU(Maximum Transfer Unit**

       <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200211182857715.png" alt="image-20200211182857715" style="zoom:50%;" />

     + 数据时由可打印的ASCII码组成的文本文件时，帧定界可以使用特殊的**帧定界符**。

     + 控制字符SOH(Start of Header)，编码00000001，放在一帧的最前面，表示帧的首部开始。

     + 控制字符EOT(End of Transmission)，编码00000100表示帧的结束。

     + 控制字符不是S/O/H/E/O/T。

       ![image-20200212060452733](X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212060452733.png)

  2. **透明传输**

     + 若出现预期外的帧定界符，则使用转义字符。

     + **透明：某一个实际存在的事物看起来却好像不存在一样。**

     + 即对所传送的数据来说，这些数据就“看不见”数据链路层有什么妨碍数据传输的东西，亦即数据链路层对这些数据来说是透明的。

     + 转义字符“ESC”（编码1B）。

     + **字节填充或字符填充：** 具体方法是发送端的数据链路层在数据中出现控制字符的前面插入转义字符，在接收端的数据链路层在把数据送至网络层前删去插入的转义字符。

       <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212061443687.png" alt="image-20200212061443687" style="zoom:50%;" />

  3. **差错检测**

     + 比特在传输过程中可能出现差错，如1->0 / 0->1，称为 **比特差错**。

       + **误码率BER(Bit Error Rate)**：在一段时间内，传输错误的比特占所传输比特总数的比率。

       + 数据链路层广泛使用 **循环冗余检验CRC(Cyclic Redundancy Check)**。

       + **帧检验序列FCS(Frame Check Sequence)**：作为检验的余数。

       + CRC指方法，FCS指末尾添加的序列。

       + 例：

         <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212063549585.png" alt="image-20200212063549585" style="zoom:30%;" /> <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212063613420.png" alt="image-20200212063613420" style="zoom:33%;" />

       + 将接收的数据除以P（模2）若余数为0则正确，接受；否则错误，丢弃。

       + **凡是接收端数据链路层接受的帧均无差错，但不能做到对帧的无差错接受。**

       + *可以看出数据链路层主要提供数据传输的可靠性保证。*

     + 除了最简单的比特差错外，没有出现比特差错却出现了 如下状况称 **出现传输差错**：

       + **帧丢失**：收到1，3，丢失2。
       + **帧重复**：收到1，2，2，3。
       + **帧失序**：收到1，3，2。
       + 解决方案是增加**帧编号**、**确认**与**重传机制**。
       + 如今因为传输技术的提高，采用区别对待以平衡正确性与速率的最优化。

## 3.2 点对点协议PPP(Point-to-Point Protocol)

### 3.2.1 PPP协议的特点

1. **PPP协议应满足的需求**
   1. **简单**
      + IETF在设计互联网体系结构时将最复杂部分放在TCP协议中，而网际协议IP则相对比较简单，提供不可靠的数据报服务。
      + 对数据链路层的帧**不需纠错，不需序号，不需流量控制**。
      + 接收方收到帧，对收，错弃。
      + 简单为首要要求，提高互操作性。
   2. **封装成帧**
      + PPP协议必须规定特殊的字符作为 **帧定界符**，以便准确找到帧的开始与结束位置。
   3. **透明性**
      + 有效解决帧定界符与数据重复的问题。
   4. **多种网络层协议**
      + 必须能够 **在同一条物理链路上同时支持多种网络层协议**。
      + 当点对点链路所连接的时局域网或路由器时，PPP协议必须同时支持在链路所连接的局域网或路由器上运行的各种网络层协议。
   5. **多种类型链路**：
      + 支持如串行/并行、同步/异步、低速/高速、电的/光的、交换的/非交换的点对点链路。
      + PPPoE (PPP over Ethernet)
   6. **差错检测**
      - 作为接收数据的第一层，及时的判断差错是否存在可节省大量资源。
   7. **检测连接状态**
      - 可自动检测链路是否处于正常工作状态。
   8. **最大传送单元**
      - 必须对每一种类型的点对点链路设置 **最大传送单元MTU的默认值**，促进各种实现之间的互操作性。
      - **MTU时数据链路层的帧*可以载荷的数据部分*的最大长度而非*帧的总长度*。**
   9. **网络层地址协商**
      + 必须提供一种机制使得通信的两个网络层的实体能够通过协商知道或能配置彼此的网络层地址。
      + 简单且能在所有情况下得出协商结果。
   10. **数据压缩协商**
       + 必须提供一种方法来协商数据压缩算法。但PPP协议并不要求将数据压缩算法进行标准化。
       + TCP/IP协议族中，可靠传输由运输层的TCP协议负责，因此数据链路层的PPP协议不需要进行纠错，设序号，或进行流量控制。
2. **PPP协议的组成**（三部分）
   1. 一个将IP数据报封装到串行链路的方法。
      + PPP既支持异步，也支持面向比特的同步链路。
      + IP数据报在PPP帧中就是其信息部分。长度由MTU限制。
   2. 一个用来建立、配置、测试数据链路连接的 **链路控制协议LCP(Link Control Protocol)**。
      + 通信双方可协商一些选项。
   3. 一套 **网络控制协议NCP(Network Control Protocol)**。
      + 期中每个协议支持不同的网络层协议。

### 3.2.2 PPP协议的帧格式

<img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212191823260.png" alt="image-20200212191823260" style="zoom:50%;" />

1. **各字段的意义**
   + PPP帧的首部和尾部分别为四个字段与两个字段。
   + 连续出现两个标志字段就表示这是一个空帧，应当丢弃。
2. **字节填充**
   + 当信息字段中出现和标志字段一样的比特（0x7E）组合时，就必须采取一些措施使这种形式上和标志字段一样的比特组合不出现在信息字段中，亦即 **支持更多字符的透明化**。
   + 填充后字节数超过原来的字节数，接收端逆变换后恢复出原来信息。
3. **零比特填充**
   + **F为0x7E**
   + 为避免F的识别错误，发送端每5个1后添加一个0，接收端每5个1后删去一个0。

### 3.2.3 PPP协议的工作状态

<img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212212334032.png" alt="image-20200212212334032" style="zoom:50%;" />

+ 链路建立中协商LCP的一些配置选项，发送LCP的配置请求帧，是一个PPP帧，链路另一边回复：
  + 配置确认帧(Configure-Ack)：所有选项都接受。
  + 配置否认帧(Configure-Nak)：所有选项都理解但不能接受。
  + 配置拒绝帧(Configure-Reject)：选项有的无法识别或不能接受，需要协商。
+ 链路静止->物理链路->LCP链路->鉴别->NCP链路->交换数据

## 3.3 使用广播信道的数据链路层

### 3.3.1 局域网的数据链路层

+ 局域网最主要的特点：**网络为一个单位所拥有，且地理范围和站点数目均有限。**
+ 局域网的主要优点：
  + 具有广播功能，从一个站点可以很方便地访问全网，局域网上的主机可共享连接在局域网上的各种硬件和软件资源。
  + 便于系统的扩展和逐渐演变，各设备的位置可灵活调整和改变。
  + 提高了系统的可靠性(reliability)，可用性(availability)和生存性(survivability)。

+ 常见拓扑结构有：星形，环形，总线……
+ **共享信道**着重要考虑的一个问题就是如何使众多用户合理方便地共享通信媒体资源，两种方法：
  1. **静态划分信道**
     + 只要分配到了信道就不会和其他用户发生冲突，但是局域网内该方法代价高，不适合局域网。
  2. **动态媒体接入控制**
     + 又称 **多点接入**，特点是信道并非在用户通信时固定分配给用户。分两类：
       + **随机接入**。所有用户随机发信息，如果恰巧产生冲突，碰撞，则失败，因此要有解决碰撞的网络协议。
       + **受控接入**。用户必须服从一定的控制。例如分散控制的**令牌环局域网**和**集中控制的多点线路探寻**或**轮询**。较少。

+ 传统以太网——表示最早流行的10Mbit/s速率以太网。

1. 以太网的两个标准
   + IEEE 802委员会是专门制定局域网和城域网标准的机构。
   + 1983年制定了第一个IEEE的以太网标准IEEE 802.3[W-IEEE802.3]，数据率为10Mbit/s。
2. 适配器的作用
   
   +  计算机与外界局域网的连接是通过通信适配器进行的。
   
   + 网络接口板又称为**网络接口卡NIC（Network Interface Card）**，或简称为**网卡**
   
   + 这种通信适配器上装有处理器和存储器（RAM和ROM）。
   
   + 适配器的一个重要功能就是要进行数据串行传输和并行传输的转换。
   
   + 由于网络的数据率与计算机总线上的数据率并不相同，因此适配器中必须装有对数据进行缓存的存储芯片。
   
   + 适配器包含了物理层与数据链路层的功能。
   
   + 适配器接收和发送各种帧时不使用计算机的CPU，当收到正确帧时使用中断通知该计算机，并交付协议栈中的网络层。当计算机要发送IP数据报时，就由协议把IP数据报向下交给适配器，组装成帧后发送到局域网。
   
   + 计算机的硬件地址——MAC地址，就在适配器的ROM中，而计算机的软件地址——IP地址，在计算机的存储器中。
   
     <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212230954273.png" alt="image-20200212230954273" style="zoom:50%;" />

### 3.3.2 CSMA/CD协议

+ 总线的特点：当一台计算机发送数据时，总线上的所有计算机都能检测到这个数据，这就是广播通信的方式。

+ 为实现一对一通信，我们可以使每一台计算机的适配器拥有一个与其他适配器都不同的地址。

+ 接收时地址与自己相同则接收不同则丢弃。

+ 局域网上的计算机常被称为**主机、工作站、站点、站**

+ 为通信简便，以太网采取了以下两种措施：

  1. 采用较为灵活的**无连接**的工作方式。

     + 即不必先建立连接就可直接发送数据。
     + 不进行编号，也不要求对方发回确认。
     + 提供的服务是尽最大努力交付，即不可靠交付。
     + 对有差错帧是否需要重传则由高层决定。以太网并不清楚发送或接收的是否为重复帧，只有上层知道
     + 由于是总线结构，因此同一时间只允许一台计算机发送数据。使用**CSMA/CD协议**，即**载波监听多点接入/碰撞检测（Carrier Sense Multiple Access with Collision Detection）**避免碰撞情况。

  2. 以太网发送的数据都使用**曼彻斯特编码**的信号

     + 最大问题：当出现一长串的连1或连0时，接收端就无法从收到的比特流中提取位同步信号。

       <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212232800244.png" alt="image-20200212232800244" style="zoom:50%;" />

+ **CSMA/CD协议要点**

  + **多点接入**

    + 说明是总线型网络，协议实质为 **载波监听**和**碰撞检测**。

  + **载波监听**

    + 不管在发送前，发送中，每个站都必须不停地检测信道。
    + 发送前检测是为了发送权，若检测出已经有其他站在发送，则暂时不发，信道空闲时再发送。
    + 发送中检测信道，是为了及时发现有没有其他站的发送和本站的发送的碰撞，称为 **碰撞检测**。

  + **碰撞检测**

    + **边发送边监听**

    + 也称 **冲突检测**

    + 一旦发现总线上出现碰撞，其适配器就要立即停止发送。

    + 局域网分析中，常把总线上的单程端到端传播时延记为τ，最迟发生碰撞时间为2τ。

      <img src="X:\0931Xu\Study\Review\计算机网络\PhotosInMd\image-20200212234132583.png" alt="image-20200212234132583" style="zoom:50%;" />

+ 在使用CSMA/CD协议时，一个站不可能同时进行发送和接收，但必须边发送边监听信道。因此CSMA/CD协议只能 **半双工通信**。